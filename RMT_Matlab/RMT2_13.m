tic
%--------输入1----------------------------------------
beta = 0.95;
rho1 = 1.3;
rho2 = -0.4;
%--------中间变量1-------------------------------------
A = [1 0 0 0;30/beta 1/beta -1/beta 0;
    5*(1-rho1-rho2) 0 rho1 rho2;0 0 1 0];
B = [0;1/beta;0;0];
p = [-rho2 -rho1 1];
%--------输出1----------------------------------------
ans1 = 1 ./ eig (A)
ans2 = roots(p)
%--------输入2----------------------------------------
R = [zeros(1,4);0 1e-6 0 0;zeros(2,4)];
Q = 1;
Fj = [0 0 0 0];
Pj = [zeros(4,4)];
%--------中间变量2-------------------------------------
%Howard改进算法方程%
dif = 50;
iter = 1;
while dif > 1e-8
    Pj = R + Fj' *Q*Fj + beta*(A-B*Fj)' *Pj* (A-B*Fj);
    Fj1 = beta * (Q+beta*B'*Pj*B) \ B'*Pj*A;
    Z = [max(abs(Fj1-Fj)) max(abs(Fj1-Fj))];
    dif = max(Z);
    Fj = Fj1;
    iter = iter+1;
    if iter > 5000
        disp('Error!!!')
    end
end
%--------输出2----------------------------------------
iter
F = Fj
%--------输入3----------------------------------------
C = [0;0.05;0;0];

%--------输出3----------------------------------------

%----------------------------------------------------
t = toc