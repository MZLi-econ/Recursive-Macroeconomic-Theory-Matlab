function [F,P] = RMT5_1(beta,A,B,R,Q,H)m = max(size(B));[~,cb] = size(A);if nargin == 5     H = zeros(m,cb);endif min(abs(eig(Q))) > 1e-8    A = sqrt(beta)*(A-B*(Q\H'));    B = sqrt(beta)*B;    R = R-H'*(Q\H);        [k,s] = doubleo(A',B',R,Q);    F = k'+(Q\H);    P = s;else    p0 = -0.01*eye(m);    dif = 1;    iter = 0;  while (dif > 1e-8 && iter < 1000)    f0 = (Q+beta*B'*p0*B)\(beta*B'*p0*A+H);    p1 = beta*A'*p0*A + R -(beta*A'*p0*B+H')*f0;    f1 = (Q+beta*B'*p1*B)\(beta*B'*p1*A+H);    dif = max(max(abs(f1-f0)));    iter = iter+1;    p0 = p1;  end  if iter >= 1000      disp('WARNING: Iteration limit of 1000');   end  F = f1;  P = p0;end